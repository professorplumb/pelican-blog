Graphing Calculator, Part 1
###########################

:date: 07-07-2013
:tags: d3.js, svg, graphing-calculator
:category: code
:author: Eric Plumb
:summary: Simple plotting of mathematical functions using d3.js, part 1

Welcome!  I am teaching myself `d3.js <http://d3js.org>`_ and have decided to create a rudimentary graphing calculator as
a proof of concept.  I'm detailing the learning process as I go so there will be pitfalls and backtracks :html_entity:`mdash` in other words,
this is more of a whiteboard demo than a tutorial.

I am not starting from scratch :html_entity:`mdash` I went through Scott Murray's excellent
`d3 tutorial <http://alignedleft.com/tutorials/d3/>`_
to familiarize myself with d3, and will build on that.  This demo assumes familiarity with the concepts covered in his
tutorial, so if you haven't gone through that yet, please do.  I'll wait here.

Setting Up the Basics
=====================
Let's get started by setting up an SVG element.

.. code-block:: javascript

    var svg = d3.select('body').append('svg:svg'),
            w = 500, h = 250;
    svg.attr('width', w).attr('height', h);

This is just a blank canvas.  Let's put some axes and scales on [1]_:

.. code-block:: javascript

    var padding = 20,
    xMax = 100,
    yMax = 10,
    xScale = d3.scale.linear()
            .domain([0, xMax])
            .range([padding, w - padding]),
    yScale = d3.scale.linear()
            .domain([0, yMax])
            .range([h - padding, padding]);
    xAxis = d3.svg.axis()
            .scale(xScale)
            .orient('bottom'),
    yAxis = d3.svg.axis()
            .scale(yScale)
            .orient('left');

    svg.append('svg:g')
            .attr('class', "axis")
            .attr('transform', "translate(0," + (h - 20) + ")")
            .call(xAxis);
    svg.append('svg:g')
            .attr('class', "axis")
            .attr('transform', "translate(20,0)")
            .call(yAxis);

and style them:

.. code-block:: css

    <style type="text/css">
        svg .axis path, svg .axis line {
            fill: none;
            stroke: black;
            shape-rendering: crispEdges;
        }
        svg .axis text {
            font-family: sans-serif;
            font-size: 11px;
            text-anchor: middle;
        }
    </style>

.. raw:: html

    <style type="text/css">
        svg .axis path, svg .axis line {
            fill: none;
            stroke: black;
            shape-rendering: crispEdges;
        }
        svg .axis text {
            font-family: sans-serif;
            font-size: 11px;
            text-anchor: middle;
        }
    </style>

    <svg width="500" height="250"><g class="axis" transform="translate(0,230)"><g class="tick major" transform="translate(20,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">0</text></g><g class="tick major" transform="translate(66,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">10</text></g><g class="tick major" transform="translate(112,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">20</text></g><g class="tick major" transform="translate(158,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">30</text></g><g class="tick major" transform="translate(204,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">40</text></g><g class="tick major" transform="translate(250,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">50</text></g><g class="tick major" transform="translate(296,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">60</text></g><g class="tick major" transform="translate(342.00000000000006,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">70</text></g><g class="tick major" transform="translate(388,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">80</text></g><g class="tick major" transform="translate(434,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">90</text></g><g class="tick major" transform="translate(480,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">100</text></g><path class="domain" d="M20,6V0H480V6"></path></g><g class="axis" transform="translate(20,0)"><g class="tick major" transform="translate(0,230)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">0</text></g><g class="tick major" transform="translate(0,209)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">1</text></g><g class="tick major" transform="translate(0,188)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">2</text></g><g class="tick major" transform="translate(0,167)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">3</text></g><g class="tick major" transform="translate(0,146)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">4</text></g><g class="tick major" transform="translate(0,125)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">5</text></g><g class="tick major" transform="translate(0,103.99999999999999)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">6</text></g><g class="tick major" transform="translate(0,83)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">7</text></g><g class="tick major" transform="translate(0,62)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">8</text></g><g class="tick major" transform="translate(0,41)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">9</text></g><g class="tick major" transform="translate(0,20)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">10</text></g><path class="domain" d="M-6,20H0V230H-6"></path></g></svg>

(Note that the minimums and maximums for the axes are hardcoded.  This will change shortly when we start to enter data.)

Adding a Function
=================
Scott's final example displays random points which change each time you load the page.  I want to adapt that to display
the points along the curve of a mathematical function.  I'm going to use ``Math.sqrt`` since it's easy to display and
fits nicely with the domains I hardcoded for the axes.

.. code-block:: javascript

    var plotfunc = Math.sqrt,
            plotdata = [];
    var lowX = 0, highX = 100, dX = 1;
    for (var i=lowX; i<highX; i+= dX) {
        plotdata.push([i, plotfunc(i)]);
    }

    // check that points were entered correctly
    for (var i=0; i<plotdata.length; i+=10) {
        console.log("(" + plotdata[i][0] + ", " + plotdata[i][1] + ")");
    }

    // console output:
    (0, 0)
    (10, 3.1622776601683795)
    (20, 4.47213595499958)
    (30, 5.477225575051661)
    (40, 6.324555320336759)
    (50, 7.0710678118654755)
    (60, 7.745966692414834)
    (70, 8.366600265340756)
    (80, 8.94427190999916)
    (90, 9.486832980505138)

Looks like our data are valid.  Now let's display them.  Since I just finished Scott's scatterplot tutorial [2]_, I have
the code left to display circles at x/y coordinates, so I will just adapt that for now.

.. code-block:: javascript

    svg.selectAll('circle')
            .data(plotdata)
        .enter()
            .append('svg:circle')
            .attr('cx', function(d, i) { return xScale(d[0]); })
            .attr('cy', function(d, i) { return yScale(d[1]); })
            .attr('r', 2);

.. raw:: html

    <svg width="500" height="250"><g class="axis" transform="translate(0,230)"><g class="tick major" transform="translate(20,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">0</text></g><g class="tick major" transform="translate(66,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">10</text></g><g class="tick major" transform="translate(112,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">20</text></g><g class="tick major" transform="translate(158,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">30</text></g><g class="tick major" transform="translate(204,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">40</text></g><g class="tick major" transform="translate(250,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">50</text></g><g class="tick major" transform="translate(296,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">60</text></g><g class="tick major" transform="translate(342.00000000000006,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">70</text></g><g class="tick major" transform="translate(388,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">80</text></g><g class="tick major" transform="translate(434,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">90</text></g><g class="tick major" transform="translate(480,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">100</text></g><path class="domain" d="M20,6V0H480V6"></path></g><g class="axis" transform="translate(20,0)"><g class="tick major" transform="translate(0,230)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">0</text></g><g class="tick major" transform="translate(0,209)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">1</text></g><g class="tick major" transform="translate(0,188)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">2</text></g><g class="tick major" transform="translate(0,167)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">3</text></g><g class="tick major" transform="translate(0,146)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">4</text></g><g class="tick major" transform="translate(0,125)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">5</text></g><g class="tick major" transform="translate(0,103.99999999999999)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">6</text></g><g class="tick major" transform="translate(0,83)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">7</text></g><g class="tick major" transform="translate(0,62)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">8</text></g><g class="tick major" transform="translate(0,41)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">9</text></g><g class="tick major" transform="translate(0,20)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">10</text></g><path class="domain" d="M-6,20H0V230H-6"></path></g><circle cx="20" cy="230" r="2"></circle><circle cx="24.6" cy="209" r="2"></circle><circle cx="29.200000000000003" cy="200.301515190165" r="2"></circle><circle cx="33.8" cy="193.62693304105358" r="2"></circle><circle cx="38.400000000000006" cy="188" r="2"></circle><circle cx="43" cy="183.04257247250442" r="2"></circle><circle cx="47.599999999999994" cy="178.56071540155327" r="2"></circle><circle cx="52.2" cy="174.4392224676436" r="2"></circle><circle cx="56.800000000000004" cy="170.60303038032998" r="2"></circle><circle cx="61.4" cy="167" r="2"></circle><circle cx="66" cy="163.592169136464" r="2"></circle><circle cx="70.6" cy="160.35087940253658" r="2"></circle><circle cx="75.19999999999999" cy="157.25386608210715" r="2"></circle><circle cx="79.80000000000001" cy="154.28342321525622" r="2"></circle><circle cx="84.4" cy="151.42519487774723" r="2"></circle><circle cx="89" cy="148.66734972964423" r="2"></circle><circle cx="93.60000000000001" cy="146" r="2"></circle><circle cx="98.2" cy="143.41478186202914" r="2"></circle><circle cx="102.8" cy="140.90454557049503" r="2"></circle><circle cx="107.4" cy="138.46312218564583" r="2"></circle><circle cx="112" cy="136.08514494500884" r="2"></circle><circle cx="116.6" cy="133.76591040592734" r="2"></circle><circle cx="121.2" cy="131.50126904370796" r="2"></circle><circle cx="125.80000000000001" cy="129.2875380104329" r="2"></circle><circle cx="130.39999999999998" cy="127.12143080310652" r="2"></circle><circle cx="135" cy="125" r="2"></circle><circle cx="139.60000000000002" cy="122.92059021455151" r="2"></circle><circle cx="144.2" cy="120.88079912316071" r="2"></circle><circle cx="148.8" cy="118.87844493528719" r="2"></circle><circle cx="153.39999999999998" cy="116.91153905017542" r="2"></circle><circle cx="158" cy="114.9782629239151" r="2"></circle><circle cx="162.6" cy="113.07694838056953" r="2"></circle><circle cx="167.20000000000002" cy="111.20606076066" r="2"></circle><circle cx="171.8" cy="109.3641844227014" r="2"></circle><circle cx="176.4" cy="107.55001020824868" r="2"></circle><circle cx="181.00000000000003" cy="105.76232455490806" r="2"></circle><circle cx="185.6" cy="103.99999999999999" r="2"></circle><circle cx="190.2" cy="102.26198686373738" r="2"></circle><circle cx="194.8" cy="100.54730593765149" r="2"></circle><circle cx="199.4" cy="98.85504203363362" r="2"></circle><circle cx="204" cy="97.18433827292804" r="2"></circle><circle cx="208.60000000000002" cy="95.53439101391018" r="2"></circle><circle cx="213.2" cy="93.90444533343492" r="2"></circle><circle cx="217.79999999999998" cy="92.29379098965799" r="2"></circle><circle cx="222.4" cy="90.70175880507318" r="2"></circle><circle cx="227" cy="89.12771741751322" r="2"></circle><circle cx="231.60000000000002" cy="87.57107035436937" r="2"></circle><circle cx="236.20000000000002" cy="86.03125339157808" r="2"></circle><circle cx="240.79999999999998" cy="84.5077321642143" r="2"></circle><circle cx="245.4" cy="83" r="2"></circle><circle cx="250" cy="81.50757595082501" r="2"></circle><circle cx="254.6" cy="80.03000300060012" r="2"></circle><circle cx="259.20000000000005" cy="78.56684643051244" r="2"></circle><circle cx="263.8" cy="77.11769232510912" r="2"></circle><circle cx="268.4" cy="75.68214620465977" r="2"></circle><circle cx="273" cy="74.25983177099107" r="2"></circle><circle cx="277.6" cy="72.85038975549446" r="2"></circle><circle cx="282.20000000000005" cy="71.45347685931424" r="2"></circle><circle cx="286.79999999999995" cy="70.0687647768579" r="2"></circle><circle cx="291.4" cy="68.69593929475923" r="2"></circle><circle cx="296" cy="67.33469945928849" r="2"></circle><circle cx="300.59999999999997" cy="65.98475680596027" r="2"></circle><circle cx="305.2" cy="64.64583464575196" r="2"></circle><circle cx="309.8" cy="63.317667402930766" r="2"></circle><circle cx="314.40000000000003" cy="62" r="2"></circle><circle cx="319" cy="60.69258728573047" r="2"></circle><circle cx="323.6" cy="59.395193502644815" r="2"></circle><circle cx="328.20000000000005" cy="58.107591790678526" r="2"></circle><circle cx="332.8" cy="56.82956372405826" r="2"></circle><circle cx="337.40000000000003" cy="55.56089887872042" r="2"></circle><circle cx="342.00000000000006" cy="54.301394427844144" r="2"></circle><circle cx="346.59999999999997" cy="53.050854763296456" r="2"></circle><circle cx="351.2" cy="51.809091140990034" r="2"></circle><circle cx="355.8" cy="50.57592134833186" r="2"></circle><circle cx="360.4" cy="49.35116939210482" r="2"></circle><circle cx="365" cy="48.13466520526785" r="2"></circle><circle cx="369.6" cy="46.92624437129169" r="2"></circle><circle cx="374.2" cy="45.725747864765395" r="2"></circle><circle cx="378.8" cy="44.533021807115205" r="2"></circle><circle cx="383.40000000000003" cy="43.34791723637264" r="2"></circle><circle cx="388" cy="42.17028989001764" r="2"></circle><circle cx="392.6" cy="41" r="2"></circle><circle cx="397.20000000000005" cy="39.836912099114244" r="2"></circle><circle cx="401.8" cy="38.68089483796973" r="2"></circle><circle cx="406.4" cy="37.531820811854715" r="2"></circle><circle cx="411" cy="36.389566396849375" r="2"></circle><circle cx="415.59999999999997" cy="35.254011594590196" r="2"></circle><circle cx="420.2" cy="34.12503988513487" r="2"></circle><circle cx="424.8" cy="33.00253808741596" r="2"></circle><circle cx="429.40000000000003" cy="31.886396226811314" r="2"></circle><circle cx="434" cy="30.77650740939208" r="2"></circle><circle cx="438.6" cy="29.672767702441405" r="2"></circle><circle cx="443.20000000000005" cy="28.575076020865794" r="2"></circle><circle cx="447.8" cy="27.483334019147946" r="2"></circle><circle cx="452.40000000000003" cy="26.397445988514164" r="2"></circle><circle cx="457.00000000000006" cy="25.317318759011783" r="2"></circle><circle cx="461.59999999999997" cy="24.24286160621304" r="2"></circle><circle cx="466.2" cy="23.173986162281807" r="2"></circle><circle cx="470.8" cy="22.110606331155026" r="2"></circle><circle cx="475.4" cy="21.052638207609817" r="2"></circle></svg>

Very nice!

Dys-function
============

Let's try it with a different function to see how extensible it is:

.. code-block:: javascript

    var plotfunc = Math.exp,
    ...

.. raw:: html

    <svg width="500" height="250"><g class="axis" transform="translate(0,230)"><g class="tick major" transform="translate(20,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">0</text></g><g class="tick major" transform="translate(66,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">10</text></g><g class="tick major" transform="translate(112,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">20</text></g><g class="tick major" transform="translate(158,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">30</text></g><g class="tick major" transform="translate(204,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">40</text></g><g class="tick major" transform="translate(250,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">50</text></g><g class="tick major" transform="translate(296,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">60</text></g><g class="tick major" transform="translate(342.00000000000006,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">70</text></g><g class="tick major" transform="translate(388,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">80</text></g><g class="tick major" transform="translate(434,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">90</text></g><g class="tick major" transform="translate(480,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">100</text></g><path class="domain" d="M20,6V0H480V6"></path></g><g class="axis" transform="translate(20,0)"><g class="tick major" transform="translate(0,230)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">0</text></g><g class="tick major" transform="translate(0,209)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">1</text></g><g class="tick major" transform="translate(0,188)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">2</text></g><g class="tick major" transform="translate(0,167)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">3</text></g><g class="tick major" transform="translate(0,146)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">4</text></g><g class="tick major" transform="translate(0,125)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">5</text></g><g class="tick major" transform="translate(0,103.99999999999999)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">6</text></g><g class="tick major" transform="translate(0,83)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">7</text></g><g class="tick major" transform="translate(0,62)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">8</text></g><g class="tick major" transform="translate(0,41)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">9</text></g><g class="tick major" transform="translate(0,20)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">10</text></g><path class="domain" d="M-6,20H0V230H-6"></path></g><circle cx="20" cy="209" r="2"></circle><circle cx="24.6" cy="172.91608160236004" r="2"></circle><circle cx="29.200000000000003" cy="74.82982192245635" r="2"></circle><circle cx="33.8" cy="-191.79627538694103" r="2"></circle><circle cx="38.400000000000006" cy="-916.5611506960288" r="2"></circle><circle cx="43" cy="-2886.6763411541083" r="2"></circle><circle cx="47.599999999999994" cy="-8242.004663347438" r="2"></circle><circle cx="52.2" cy="-22799.296326997624" r="2"></circle><circle cx="56.800000000000004" cy="-62370.11772787629" r="2"></circle><circle cx="61.4" cy="-169934.76247908303" r="2"></circle><circle cx="66" cy="-462325.78169094096" r="2"></circle><circle cx="70.6" cy="-1257126.9760191552" r="2"></circle><circle cx="75.19999999999999" cy="-3417620.6197990812" r="2"></circle><circle cx="79.80000000000001" cy="-9290451.232187327" r="2"></circle><circle cx="84.4" cy="-25254459.967460327" r="2"></circle><circle cx="89" cy="-68649134.8219143" r="2"></circle><circle cx="93.60000000000001" cy="-186608090.93066528" r="2"></circle><circle cx="98.2" cy="-507253777.82508147" r="2"></circle><circle cx="102.8" cy="-1378859121.8839402" r="2"></circle><circle cx="107.4" cy="-3748128090.226938" r="2"></circle><circle cx="112" cy="-10188468873.6056" r="2"></circle><circle cx="116.6" cy="-27695130194.14757" r="2"></circle><circle cx="121.2" cy="-75283169538.76353" r="2"></circle><circle cx="125.80000000000001" cy="-204640872141.22708" r="2"></circle><circle cx="130.39999999999998" cy="-556271564496.7141" r="2"></circle><circle cx="135" cy="-1512102885855.1055" r="2"></circle><circle cx="139.60000000000002" cy="-4110321797775.6147" r="2"></circle><circle cx="144.2" cy="-11173013052407.797" r="2"></circle><circle cx="148.8" cy="-30371398349891.01" r="2"></circle><circle cx="153.39999999999998" cy="-82558020239794.9" r="2"></circle><circle cx="158" cy="-224415966211784.12" r="2"></circle><circle cx="162.6" cy="-610025842969966.6" r="2"></circle><circle cx="167.20000000000002" cy="-1658222163836063" r="2"></circle><circle cx="171.8" cy="-4507515175504001" r="2"></circle><circle cx="176.4" cy="-12252696593076334" r="2"></circle><circle cx="181.00000000000003" cy="-33306282498581910" r="2"></circle><circle cx="185.6" cy="-90535862489418720" r="2"></circle><circle cx="190.2" cy="-246101989828854850" r="2"></circle><circle cx="194.8" cy="-668974566899390500" r="2"></circle><circle cx="199.4" cy="-1818461408903865300" r="2"></circle><circle cx="204" cy="-4943090603577424000" r="2"></circle><circle cx="208.60000000000002" cy="-13436713364131190000" r="2"></circle><circle cx="213.2" cy="-36524773771930456000" r="2"></circle><circle cx="217.79999999999998" cy="-99284628832816280000" r="2"></circle><circle cx="222.4" cy="-269883602401546170000" r="2"></circle><circle cx="227" cy="-733619692207185600000" r="2"></circle><circle cx="231.60000000000002" cy="-1.9941850783265142e+21" r="2"></circle><circle cx="236.20000000000002" cy="-5.420757060999156e+21" r="2"></circle><circle cx="240.79999999999998" cy="-1.4735145415405103e+22" r="2"></circle><circle cx="245.4" cy="-4.005427802239709e+22" r="2"></circle><circle cx="250" cy="-1.0887881610032877e+23" r="2"></circle><circle cx="254.6" cy="-2.959633073096587e+23" r="2"></circle><circle cx="259.20000000000005" cy="-8.04511680150481e+23" r="2"></circle><circle cx="263.8" cy="-2.1868894809361136e+24" r="2"></circle><circle cx="268.4" cy="-5.944581936876888e+24" r="2"></circle><circle cx="273" cy="-1.6159049056798229e+25" r="2"></circle><circle cx="277.6" cy="-4.392484941627302e+25" r="2"></circle><circle cx="282.20000000000005" cy="-1.1940011998605505e+26" r="2"></circle><circle cx="286.79999999999995" cy="-3.245631764739217e+26" r="2"></circle><circle cx="291.4" cy="-8.822541847960101e+26" r="2"></circle><circle cx="296" cy="-2.3982155186129468e+27" r="2"></circle><circle cx="300.59999999999997" cy="-6.519025664974029e+27" r="2"></circle><circle cx="305.2" cy="-1.7720549004357094e+28" r="2"></circle><circle cx="309.8" cy="-4.8169446348862e+28" r="2"></circle><circle cx="314.40000000000003" cy="-1.3093813069704388e+29" r="2"></circle><circle cx="319" cy="-3.559267413261734e+29" r="2"></circle><circle cx="323.6" cy="-9.675091932095683e+29" r="2"></circle><circle cx="328.20000000000005" cy="-2.6299626587686666e+30" r="2"></circle><circle cx="332.8" cy="-7.148979704856714e+30" r="2"></circle><circle cx="337.40000000000003" cy="-1.9432941623734433e+31" r="2"></circle><circle cx="342.00000000000006" cy="-5.282421208930247e+31" r="2"></circle><circle cx="346.59999999999997" cy="-1.4359109582501781e+32" r="2"></circle><circle cx="351.2" cy="-3.903210665096656e+32" r="2"></circle><circle cx="355.8" cy="-1.0610026623579887e+33" r="2"></circle><circle cx="360.4" cy="-2.8841042570343936e+33" r="2"></circle><circle cx="365" cy="-7.839808193277933e+33" r="2"></circle><circle cx="369.6" cy="-2.1310808150391644e+34" r="2"></circle><circle cx="374.2" cy="-5.792878254498663e+34" r="2"></circle><circle cx="378.8" cy="-1.5746675693679198e+35" r="2"></circle><circle cx="383.40000000000003" cy="-4.280390239676631e+35" r="2"></circle><circle cx="388" cy="-1.1635307007226464e+36" r="2"></circle><circle cx="392.6" cy="-3.162804360628575e+36" r="2"></circle><circle cx="397.20000000000005" cy="-8.597393620467699e+36" r="2"></circle><circle cx="401.8" cy="-2.337013885062697e+37" r="2"></circle><circle cx="406.4" cy="-6.352662376622377e+37" r="2"></circle><circle cx="411" cy="-1.7268326700708083e+38" r="2"></circle><circle cx="415.59999999999997" cy="-4.6940178678429385e+38" r="2"></circle><circle cx="420.2" cy="-1.2759663472619475e+39" r="2"></circle><circle cx="424.8" cy="-3.468436135487422e+39" r="2"></circle><circle cx="429.40000000000003" cy="-9.42818692026613e+39" r="2"></circle><circle cx="434" cy="-2.562846918067456e+40" r="2"></circle><circle cx="438.6" cy="-6.966540206505045e+40" r="2"></circle><circle cx="443.20000000000005" cy="-1.893701965057217e+41" r="2"></circle><circle cx="447.8" cy="-5.147615640132228e+41" r="2"></circle><circle cx="452.40000000000003" cy="-1.399267005446295e+42" r="2"></circle><circle cx="457.00000000000006" cy="-3.803602074066952e+42" r="2"></circle><circle cx="461.59999999999997" cy="-1.0339262400625347e+43" r="2"></circle><circle cx="466.2" cy="-2.81050291032896e+43" r="2"></circle><circle cx="470.8" cy="-7.639738989978546e+43" r="2"></circle><circle cx="475.4" cy="-2.0766963670628783e+44" r="2"></circle></svg>

Oops!  What's happening here?  Let's try a function which doesn't grow quite as quickly.

.. code-block:: javascript

    var plotfunc = function(x) { return x; },
    ...

.. raw:: html

    <svg width="500" height="250"><g class="axis" transform="translate(0,230)"><g class="tick major" transform="translate(20,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">0</text></g><g class="tick major" transform="translate(66,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">10</text></g><g class="tick major" transform="translate(112,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">20</text></g><g class="tick major" transform="translate(158,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">30</text></g><g class="tick major" transform="translate(204,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">40</text></g><g class="tick major" transform="translate(250,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">50</text></g><g class="tick major" transform="translate(296,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">60</text></g><g class="tick major" transform="translate(342.00000000000006,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">70</text></g><g class="tick major" transform="translate(388,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">80</text></g><g class="tick major" transform="translate(434,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">90</text></g><g class="tick major" transform="translate(480,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">100</text></g><path class="domain" d="M20,6V0H480V6"></path></g><g class="axis" transform="translate(20,0)"><g class="tick major" transform="translate(0,230)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">0</text></g><g class="tick major" transform="translate(0,209)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">1</text></g><g class="tick major" transform="translate(0,188)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">2</text></g><g class="tick major" transform="translate(0,167)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">3</text></g><g class="tick major" transform="translate(0,146)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">4</text></g><g class="tick major" transform="translate(0,125)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">5</text></g><g class="tick major" transform="translate(0,103.99999999999999)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">6</text></g><g class="tick major" transform="translate(0,83)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">7</text></g><g class="tick major" transform="translate(0,62)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">8</text></g><g class="tick major" transform="translate(0,41)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">9</text></g><g class="tick major" transform="translate(0,20)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">10</text></g><path class="domain" d="M-6,20H0V230H-6"></path></g><circle cx="20" cy="230" r="2"></circle><circle cx="24.6" cy="209" r="2"></circle><circle cx="29.200000000000003" cy="188" r="2"></circle><circle cx="33.8" cy="167" r="2"></circle><circle cx="38.400000000000006" cy="146" r="2"></circle><circle cx="43" cy="125" r="2"></circle><circle cx="47.599999999999994" cy="103.99999999999999" r="2"></circle><circle cx="52.2" cy="83" r="2"></circle><circle cx="56.800000000000004" cy="62" r="2"></circle><circle cx="61.4" cy="41" r="2"></circle><circle cx="66" cy="20" r="2"></circle><circle cx="70.6" cy="-1.0000000000000284" r="2"></circle><circle cx="75.19999999999999" cy="-22.00000000000003" r="2"></circle><circle cx="79.80000000000001" cy="-43" r="2"></circle><circle cx="84.4" cy="-64" r="2"></circle><circle cx="89" cy="-85" r="2"></circle><circle cx="93.60000000000001" cy="-106" r="2"></circle><circle cx="98.2" cy="-127.00000000000006" r="2"></circle><circle cx="102.8" cy="-148" r="2"></circle><circle cx="107.4" cy="-169" r="2"></circle><circle cx="112" cy="-190" r="2"></circle><circle cx="116.6" cy="-211" r="2"></circle><circle cx="121.2" cy="-232.00000000000006" r="2"></circle><circle cx="125.80000000000001" cy="-253.00000000000006" r="2"></circle><circle cx="130.39999999999998" cy="-274.00000000000006" r="2"></circle><circle cx="135" cy="-295" r="2"></circle><circle cx="139.60000000000002" cy="-316" r="2"></circle><circle cx="144.2" cy="-337" r="2"></circle><circle cx="148.8" cy="-358" r="2"></circle><circle cx="153.39999999999998" cy="-379.0000000000001" r="2"></circle><circle cx="158" cy="-400" r="2"></circle><circle cx="162.6" cy="-421" r="2"></circle><circle cx="167.20000000000002" cy="-442" r="2"></circle><circle cx="171.8" cy="-463" r="2"></circle><circle cx="176.4" cy="-484.0000000000001" r="2"></circle><circle cx="181.00000000000003" cy="-505" r="2"></circle><circle cx="185.6" cy="-526" r="2"></circle><circle cx="190.2" cy="-547" r="2"></circle><circle cx="194.8" cy="-568" r="2"></circle><circle cx="199.4" cy="-589.0000000000001" r="2"></circle><circle cx="204" cy="-610" r="2"></circle><circle cx="208.60000000000002" cy="-631.0000000000001" r="2"></circle><circle cx="213.2" cy="-652" r="2"></circle><circle cx="217.79999999999998" cy="-673" r="2"></circle><circle cx="222.4" cy="-694.0000000000001" r="2"></circle><circle cx="227" cy="-715" r="2"></circle><circle cx="231.60000000000002" cy="-736.0000000000001" r="2"></circle><circle cx="236.20000000000002" cy="-757" r="2"></circle><circle cx="240.79999999999998" cy="-778.0000000000001" r="2"></circle><circle cx="245.4" cy="-799" r="2"></circle><circle cx="250" cy="-820" r="2"></circle><circle cx="254.6" cy="-841" r="2"></circle><circle cx="259.20000000000005" cy="-862" r="2"></circle><circle cx="263.8" cy="-883.0000000000002" r="2"></circle><circle cx="268.4" cy="-904" r="2"></circle><circle cx="273" cy="-925" r="2"></circle><circle cx="277.6" cy="-946" r="2"></circle><circle cx="282.20000000000005" cy="-967" r="2"></circle><circle cx="286.79999999999995" cy="-988.0000000000002" r="2"></circle><circle cx="291.4" cy="-1009" r="2"></circle><circle cx="296" cy="-1030" r="2"></circle><circle cx="300.59999999999997" cy="-1051" r="2"></circle><circle cx="305.2" cy="-1072" r="2"></circle><circle cx="309.8" cy="-1093.0000000000002" r="2"></circle><circle cx="314.40000000000003" cy="-1114" r="2"></circle><circle cx="319" cy="-1135" r="2"></circle><circle cx="323.6" cy="-1156" r="2"></circle><circle cx="328.20000000000005" cy="-1177" r="2"></circle><circle cx="332.8" cy="-1198.0000000000002" r="2"></circle><circle cx="337.40000000000003" cy="-1219" r="2"></circle><circle cx="342.00000000000006" cy="-1240" r="2"></circle><circle cx="346.59999999999997" cy="-1261" r="2"></circle><circle cx="351.2" cy="-1282" r="2"></circle><circle cx="355.8" cy="-1303.0000000000002" r="2"></circle><circle cx="360.4" cy="-1324" r="2"></circle><circle cx="365" cy="-1345" r="2"></circle><circle cx="369.6" cy="-1366" r="2"></circle><circle cx="374.2" cy="-1387" r="2"></circle><circle cx="378.8" cy="-1408.0000000000002" r="2"></circle><circle cx="383.40000000000003" cy="-1429" r="2"></circle><circle cx="388" cy="-1450" r="2"></circle><circle cx="392.6" cy="-1471" r="2"></circle><circle cx="397.20000000000005" cy="-1492.0000000000002" r="2"></circle><circle cx="401.8" cy="-1513.0000000000002" r="2"></circle><circle cx="406.4" cy="-1534" r="2"></circle><circle cx="411" cy="-1555" r="2"></circle><circle cx="415.59999999999997" cy="-1576" r="2"></circle><circle cx="420.2" cy="-1597.0000000000002" r="2"></circle><circle cx="424.8" cy="-1618.0000000000002" r="2"></circle><circle cx="429.40000000000003" cy="-1639" r="2"></circle><circle cx="434" cy="-1660" r="2"></circle><circle cx="438.6" cy="-1681" r="2"></circle><circle cx="443.20000000000005" cy="-1702.0000000000002" r="2"></circle><circle cx="447.8" cy="-1723.0000000000002" r="2"></circle><circle cx="452.40000000000003" cy="-1744" r="2"></circle><circle cx="457.00000000000006" cy="-1765" r="2"></circle><circle cx="461.59999999999997" cy="-1786.0000000000002" r="2"></circle><circle cx="466.2" cy="-1807.0000000000002" r="2"></circle><circle cx="470.8" cy="-1828" r="2"></circle><circle cx="475.4" cy="-1849" r="2"></circle></svg>

Aha, I see what's happening.  Looks like my hardcoded domains of 0-100 for x and 0-10 for y aren't sufficient for a
function whose y-value gets greater than 10.  Fortunately, changing the maximums on the domains is easy.

.. code-block:: javascript

    ...
    xMax = d3.max(plotdata, function(d) { return d[0]; }),
    yMax = d3.max(plotdata, function(d) { return d[1]; }),
    ...

.. raw:: html

    <svg width="500" height="250"><g class="axis" transform="translate(0,230)"><g class="tick major" transform="translate(20,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">0</text></g><g class="tick major" transform="translate(66.46464646464648,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">10</text></g><g class="tick major" transform="translate(112.92929292929294,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">20</text></g><g class="tick major" transform="translate(159.3939393939394,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">30</text></g><g class="tick major" transform="translate(205.85858585858588,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">40</text></g><g class="tick major" transform="translate(252.32323232323233,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">50</text></g><g class="tick major" transform="translate(298.7878787878788,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">60</text></g><g class="tick major" transform="translate(345.2525252525253,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">70</text></g><g class="tick major" transform="translate(391.71717171717177,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">80</text></g><g class="tick major" transform="translate(438.18181818181824,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">90</text></g><path class="domain" d="M20,6V0H480V6"></path></g><g class="axis" transform="translate(20,0)"><g class="tick major" transform="translate(0,230)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">0</text></g><g class="tick major" transform="translate(0,208.78787878787878)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">10</text></g><g class="tick major" transform="translate(0,187.57575757575756)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">20</text></g><g class="tick major" transform="translate(0,166.36363636363637)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">30</text></g><g class="tick major" transform="translate(0,145.15151515151513)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">40</text></g><g class="tick major" transform="translate(0,123.93939393939394)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">50</text></g><g class="tick major" transform="translate(0,102.72727272727272)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">60</text></g><g class="tick major" transform="translate(0,81.5151515151515)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">70</text></g><g class="tick major" transform="translate(0,60.30303030303028)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">80</text></g><g class="tick major" transform="translate(0,39.090909090909065)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">90</text></g><path class="domain" d="M-6,20H0V230H-6"></path></g><circle cx="20" cy="230" r="2"></circle><circle cx="24.646464646464647" cy="227.87878787878788" r="2"></circle><circle cx="29.292929292929294" cy="225.75757575757575" r="2"></circle><circle cx="33.93939393939394" cy="223.63636363636363" r="2"></circle><circle cx="38.58585858585859" cy="221.5151515151515" r="2"></circle><circle cx="43.23232323232324" cy="219.3939393939394" r="2"></circle><circle cx="47.878787878787875" cy="217.27272727272728" r="2"></circle><circle cx="52.52525252525253" cy="215.15151515151516" r="2"></circle><circle cx="57.17171717171718" cy="213.03030303030303" r="2"></circle><circle cx="61.81818181818182" cy="210.9090909090909" r="2"></circle><circle cx="66.46464646464648" cy="208.78787878787878" r="2"></circle><circle cx="71.11111111111111" cy="206.66666666666666" r="2"></circle><circle cx="75.75757575757575" cy="204.54545454545453" r="2"></circle><circle cx="80.40404040404042" cy="202.42424242424244" r="2"></circle><circle cx="85.05050505050507" cy="200.3030303030303" r="2"></circle><circle cx="89.6969696969697" cy="198.1818181818182" r="2"></circle><circle cx="94.34343434343435" cy="196.06060606060606" r="2"></circle><circle cx="98.989898989899" cy="193.93939393939394" r="2"></circle><circle cx="103.63636363636364" cy="191.8181818181818" r="2"></circle><circle cx="108.28282828282829" cy="189.6969696969697" r="2"></circle><circle cx="112.92929292929294" cy="187.57575757575756" r="2"></circle><circle cx="117.57575757575758" cy="185.45454545454544" r="2"></circle><circle cx="122.22222222222223" cy="183.33333333333331" r="2"></circle><circle cx="126.86868686868688" cy="181.2121212121212" r="2"></circle><circle cx="131.5151515151515" cy="179.0909090909091" r="2"></circle><circle cx="136.16161616161617" cy="176.96969696969697" r="2"></circle><circle cx="140.80808080808083" cy="174.84848484848484" r="2"></circle><circle cx="145.45454545454547" cy="172.72727272727272" r="2"></circle><circle cx="150.10101010101013" cy="170.6060606060606" r="2"></circle><circle cx="154.74747474747474" cy="168.4848484848485" r="2"></circle><circle cx="159.3939393939394" cy="166.36363636363637" r="2"></circle><circle cx="164.04040404040404" cy="164.24242424242425" r="2"></circle><circle cx="168.6868686868687" cy="162.12121212121212" r="2"></circle><circle cx="173.33333333333334" cy="160" r="2"></circle><circle cx="177.979797979798" cy="157.87878787878788" r="2"></circle><circle cx="182.62626262626264" cy="155.75757575757575" r="2"></circle><circle cx="187.27272727272728" cy="153.63636363636363" r="2"></circle><circle cx="191.91919191919192" cy="151.5151515151515" r="2"></circle><circle cx="196.56565656565658" cy="149.39393939393938" r="2"></circle><circle cx="201.21212121212122" cy="147.27272727272725" r="2"></circle><circle cx="205.85858585858588" cy="145.15151515151513" r="2"></circle><circle cx="210.50505050505052" cy="143.030303030303" r="2"></circle><circle cx="215.15151515151516" cy="140.9090909090909" r="2"></circle><circle cx="219.79797979797982" cy="138.78787878787878" r="2"></circle><circle cx="224.44444444444446" cy="136.66666666666666" r="2"></circle><circle cx="229.09090909090912" cy="134.54545454545453" r="2"></circle><circle cx="233.73737373737376" cy="132.4242424242424" r="2"></circle><circle cx="238.38383838383842" cy="130.3030303030303" r="2"></circle><circle cx="243.03030303030303" cy="128.1818181818182" r="2"></circle><circle cx="247.6767676767677" cy="126.06060606060606" r="2"></circle><circle cx="252.32323232323233" cy="123.93939393939394" r="2"></circle><circle cx="256.969696969697" cy="121.8181818181818" r="2"></circle><circle cx="261.61616161616166" cy="119.69696969696969" r="2"></circle><circle cx="266.26262626262627" cy="117.57575757575758" r="2"></circle><circle cx="270.90909090909093" cy="115.45454545454544" r="2"></circle><circle cx="275.55555555555554" cy="113.33333333333333" r="2"></circle><circle cx="280.20202020202026" cy="111.21212121212119" r="2"></circle><circle cx="284.8484848484849" cy="109.09090909090908" r="2"></circle><circle cx="289.4949494949495" cy="106.96969696969697" r="2"></circle><circle cx="294.14141414141415" cy="104.84848484848483" r="2"></circle><circle cx="298.7878787878788" cy="102.72727272727272" r="2"></circle><circle cx="303.4343434343435" cy="100.6060606060606" r="2"></circle><circle cx="308.0808080808081" cy="98.48484848484847" r="2"></circle><circle cx="312.72727272727275" cy="96.36363636363635" r="2"></circle><circle cx="317.3737373737374" cy="94.24242424242422" r="2"></circle><circle cx="322.020202020202" cy="92.12121212121212" r="2"></circle><circle cx="326.6666666666667" cy="89.99999999999997" r="2"></circle><circle cx="331.31313131313135" cy="87.87878787878788" r="2"></circle><circle cx="335.959595959596" cy="85.75757575757575" r="2"></circle><circle cx="340.6060606060606" cy="83.63636363636363" r="2"></circle><circle cx="345.2525252525253" cy="81.5151515151515" r="2"></circle><circle cx="349.89898989898995" cy="79.39393939393938" r="2"></circle><circle cx="354.54545454545456" cy="77.27272727272728" r="2"></circle><circle cx="359.1919191919192" cy="75.15151515151513" r="2"></circle><circle cx="363.83838383838383" cy="73.03030303030303" r="2"></circle><circle cx="368.48484848484856" cy="70.90909090909088" r="2"></circle><circle cx="373.13131313131316" cy="68.78787878787878" r="2"></circle><circle cx="377.77777777777777" cy="66.66666666666666" r="2"></circle><circle cx="382.42424242424244" cy="64.54545454545453" r="2"></circle><circle cx="387.0707070707071" cy="62.42424242424241" r="2"></circle><circle cx="391.71717171717177" cy="60.30303030303028" r="2"></circle><circle cx="396.3636363636364" cy="58.18181818181816" r="2"></circle><circle cx="401.01010101010104" cy="56.060606060606034" r="2"></circle><circle cx="405.6565656565657" cy="53.93939393939394" r="2"></circle><circle cx="410.3030303030303" cy="51.81818181818181" r="2"></circle><circle cx="414.949494949495" cy="49.69696969696969" r="2"></circle><circle cx="419.59595959595964" cy="47.575757575757564" r="2"></circle><circle cx="424.2424242424243" cy="45.45454545454544" r="2"></circle><circle cx="428.8888888888889" cy="43.333333333333314" r="2"></circle><circle cx="433.5353535353536" cy="41.21212121212119" r="2"></circle><circle cx="438.18181818181824" cy="39.090909090909065" r="2"></circle><circle cx="442.82828282828285" cy="36.96969696969697" r="2"></circle><circle cx="447.4747474747475" cy="34.848484848484816" r="2"></circle><circle cx="452.1212121212121" cy="32.72727272727272" r="2"></circle><circle cx="456.76767676767685" cy="30.606060606060595" r="2"></circle><circle cx="461.41414141414145" cy="28.48484848484847" r="2"></circle><circle cx="466.06060606060606" cy="26.363636363636346" r="2"></circle><circle cx="470.7070707070707" cy="24.24242424242422" r="2"></circle><circle cx="475.3535353535354" cy="22.121212121212125" r="2"></circle><circle cx="480" cy="20" r="2"></circle></svg>

There it is.  I am going to change the function back to ``sqrt`` for the remainder of this exercise :html_entity:`mdash` the dynamic
maximums for my x and y domains should still work fine.

Getting In Line
===============

The last thing I want to do today is change the way the function is plotted from a series of points to a series of lines.
This seems pretty straightforward but as you will see there are some snags.

Whereas the SVG  ``circle`` element requires three plot attributes (``cx``, ``cy``, and ``r``), the ``line`` element
takes four: ``x1``, ``y1``, ``x2``, ``y2``.  This makes sense: it's a simple line segment which is defined by two (x, y)
endpoints, just like in freshman geometry.

Let's use item ``n`` in ``plotdata`` as point 1 and item ``n + 1`` as point 2.  This will obviously cause problems when
item ``n`` is the final item in ``plotdata``, so let's simply exclude that item from our ``data()`` call:

.. code-block:: javascript

    // Replace svg.selectAll('circle') and its chain with:
    svg.selectAll('line')
            .data(plotdata.slice(0, plotdata.length - 1))
        .enter()
            .append('svg:line')
            .attr("x1", function(d, i) { return xScale(d[0]); })
            .attr("y1", function(d, i) { return yScale(d[1]); })
            .attr("x2", function(d, i) { return xScale(plotdata[i+1][0]); })
            .attr("y2", function(d, i) { return yScale(plotdata[i+1][1]); });
            .style('stroke', "rgb(6, 120, 155)")
            .style('fill', "rgb(6, 120, 155)");

Note that I also added ``stroke`` and ``fill`` styles to liven up the plot a bit.  I could also have done this in the
CSS block, which is arguably more correct because it generates less SVG code.

.. raw:: html

    <svg width="500" height="250"><g class="axis" transform="translate(0,230)"><g class="tick major" transform="translate(20,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">0</text></g><g class="tick major" transform="translate(66.46464646464648,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">10</text></g><g class="tick major" transform="translate(112.92929292929294,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">20</text></g><g class="tick major" transform="translate(159.3939393939394,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">30</text></g><g class="tick major" transform="translate(205.85858585858588,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">40</text></g><g class="tick major" transform="translate(252.32323232323233,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">50</text></g><g class="tick major" transform="translate(298.7878787878788,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">60</text></g><g class="tick major" transform="translate(345.2525252525253,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">70</text></g><g class="tick major" transform="translate(391.71717171717177,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">80</text></g><g class="tick major" transform="translate(438.18181818181824,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">90</text></g><path class="domain" d="M20,6V0H480V6"></path></g><g class="axis" transform="translate(20,0)"><g class="tick major" transform="translate(0,230)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">0</text></g><g class="tick major" transform="translate(0,208.89420587955655)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">1</text></g><g class="tick major" transform="translate(0,187.7884117591131)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">2</text></g><g class="tick major" transform="translate(0,166.68261763866963)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">3</text></g><g class="tick major" transform="translate(0,145.57682351822618)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">4</text></g><g class="tick major" transform="translate(0,124.47102939778273)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">5</text></g><g class="tick major" transform="translate(0,103.36523527733928)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">6</text></g><g class="tick major" transform="translate(0,82.25944115689583)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">7</text></g><g class="tick major" transform="translate(0,61.153647036452355)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">8</text></g><g class="tick major" transform="translate(0,40.04785291600891)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">9</text></g><path class="domain" d="M-6,20H0V230H-6"></path></g><line x1="112.92929292929294" y1="135.6120192551461" x2="117.57575757575758" y2="133.28110084091395" style="stroke: #06789b; fill: #06789b;"></line><line x1="117.57575757575758" y1="133.28110084091395" x2="122.22222222222223" y2="131.00505063388334" style="stroke: #06789b; fill: #06789b;"></line><line x1="122.22222222222223" y1="131.00505063388334" x2="126.86868686868688" y2="128.78016723262903" style="stroke: #06789b; fill: #06789b;"></line><line x1="126.86868686868688" y1="128.78016723262903" x2="131.5151515151515" y2="126.60314757736052" style="stroke: #06789b; fill: #06789b;"></line><line x1="131.5151515151515" y1="126.60314757736052" x2="136.16161616161617" y2="124.47102939778273" style="stroke: #06789b; fill: #06789b;"></line><line x1="136.16161616161617" y1="124.47102939778273" x2="140.80808080808083" y2="122.38114392998698" style="stroke: #06789b; fill: #06789b;"></line><line x1="140.80808080808083" y1="122.38114392998698" x2="145.45454545454547" y2="120.33107674791036" style="stroke: #06789b; fill: #06789b;"></line><line x1="145.45454545454547" y1="120.33107674791036" x2="150.10101010101013" y2="118.3186350695548" style="stroke: #06789b; fill: #06789b;"></line><line x1="150.10101010101013" y1="118.3186350695548" x2="154.74747474747474" y2="116.34182027596158" style="stroke: #06789b; fill: #06789b;"></line><line x1="154.74747474747474" y1="116.34182027596158" x2="159.3939393939394" y2="114.39880466173213" style="stroke: #06789b; fill: #06789b;"></line><line x1="159.3939393939394" y1="114.39880466173213" x2="164.04040404040404" y2="112.48791164696755" style="stroke: #06789b; fill: #06789b;"></line><line x1="164.04040404040404" y1="112.48791164696755" x2="168.6868686868687" y2="110.60759884085815" style="stroke: #06789b; fill: #06789b;"></line><line x1="168.6868686868687" y1="110.60759884085815" x2="173.33333333333334" y2="108.7564434701786" style="stroke: #06789b; fill: #06789b;"></line><line x1="173.33333333333334" y1="108.7564434701786" x2="177.979797979798" y2="106.93312978118543" style="stroke: #06789b; fill: #06789b;"></line><line x1="177.979797979798" y1="106.93312978118543" x2="182.62626262626264" y2="105.13643809778173" style="stroke: #06789b; fill: #06789b;"></line><line x1="182.62626262626264" y1="105.13643809778173" x2="187.27272727272728" y2="103.36523527733928" style="stroke: #06789b; fill: #06789b;"></line><line x1="187.27272727272728" y1="103.36523527733928" x2="191.91919191919192" y2="101.6184663519781" style="stroke: #06789b; fill: #06789b;"></line><line x1="191.91919191919192" y1="101.6184663519781" x2="196.56565656565658" y2="99.89514718015809" style="stroke: #06789b; fill: #06789b;"></line><line x1="196.56565656565658" y1="99.89514718015809" x2="201.21212121212122" y2="98.19435796322196" style="stroke: #06789b; fill: #06789b;"></line><line x1="201.21212121212122" y1="98.19435796322196" x2="205.85858585858588" y2="96.51523750561705" style="stroke: #06789b; fill: #06789b;"></line><line x1="205.85858585858588" y1="96.51523750561705" x2="210.50505050505052" y2="94.8569781171208" style="stroke: #06789b; fill: #06789b;"></line><line x1="210.50505050505052" y1="94.8569781171208" x2="215.15151515151516" y2="93.21882107142477" style="stroke: #06789b; fill: #06789b;"></line><line x1="215.15151515151516" y1="93.21882107142477" x2="219.79797979797982" y2="91.60005254861744" style="stroke: #06789b; fill: #06789b;"></line><line x1="219.79797979797982" y1="91.60005254861744" x2="224.44444444444446" y2="90" style="stroke: #06789b; fill: #06789b;"></line><line x1="224.44444444444446" y1="90" x2="229.09090909090912" y2="88.41802888271914" style="stroke: #06789b; fill: #06789b;"></line><line x1="229.09090909090912" y1="88.41802888271914" x2="233.73737373737376" y2="86.85353971924735" style="stroke: #06789b; fill: #06789b;"></line><line x1="233.73737373737376" y1="86.85353971924735" x2="238.38383838383842" y2="85.30596544306451" style="stroke: #06789b; fill: #06789b;"></line><line x1="238.38383838383842" y1="85.30596544306451" x2="243.03030303030303" y2="83.77476899721384" style="stroke: #06789b; fill: #06789b;"></line><line x1="243.03030303030303" y1="83.77476899721384" x2="247.6767676767677" y2="82.25944115689583" style="stroke: #06789b; fill: #06789b;"></line><line x1="247.6767676767677" y1="82.25944115689583" x2="252.32323232323233" y2="80.75949855107271" style="stroke: #06789b; fill: #06789b;"></line><line x1="252.32323232323233" y1="80.75949855107271" x2="256.969696969697" y2="79.27448186129257" style="stroke: #06789b; fill: #06789b;"></line><line x1="256.969696969697" y1="79.27448186129257" x2="261.61616161616166" y2="77.80395417870949" style="stroke: #06789b; fill: #06789b;"></line><line x1="261.61616161616166" y1="77.80395417870949" x2="266.26262626262627" y2="76.347499502641" style="stroke: #06789b; fill: #06789b;"></line><line x1="266.26262626262627" y1="76.347499502641" x2="270.90909090909093" y2="74.90472136604075" style="stroke: #06789b; fill: #06789b;"></line><line x1="270.90909090909093" y1="74.90472136604075" x2="275.55555555555554" y2="73.47524157501473" style="stroke: #06789b; fill: #06789b;"></line><line x1="275.55555555555554" y1="73.47524157501473" x2="280.20202020202026" y2="72.05869905102546" style="stroke: #06789b; fill: #06789b;"></line><line x1="280.20202020202026" y1="72.05869905102546" x2="284.8484848484849" y2="70.65474876574109" style="stroke: #06789b; fill: #06789b;"></line><line x1="284.8484848484849" y1="70.65474876574109" x2="289.4949494949495" y2="69.26306075962614" style="stroke: #06789b; fill: #06789b;"></line><line x1="289.4949494949495" y1="69.26306075962614" x2="294.14141414141415" y2="67.88331923636551" style="stroke: #06789b; fill: #06789b;"></line><line x1="294.14141414141415" y1="67.88331923636551" x2="298.7878787878788" y2="66.51522172608017" style="stroke: #06789b; fill: #06789b;"></line><line x1="298.7878787878788" y1="66.51522172608017" x2="303.4343434343435" y2="65.15847831105395" style="stroke: #06789b; fill: #06789b;"></line><line x1="303.4343434343435" y1="65.15847831105395" x2="308.0808080808081" y2="63.812810908356056" style="stroke: #06789b; fill: #06789b;"></line><line x1="308.0808080808081" y1="63.812810908356056" x2="312.72727272727275" y2="62.47795260433219" style="stroke: #06789b; fill: #06789b;"></line><line x1="312.72727272727275" y1="62.47795260433219" x2="317.3737373737374" y2="61.153647036452355" style="stroke: #06789b; fill: #06789b;"></line><line x1="317.3737373737374" y1="61.153647036452355" x2="322.020202020202" y2="59.839647818460804" style="stroke: #06789b; fill: #06789b;"></line><line x1="322.020202020202" y1="59.839647818460804" x2="326.6666666666667" y2="58.5357180051775" style="stroke: #06789b; fill: #06789b;"></line><line x1="326.6666666666667" y1="58.5357180051775" x2="331.31313131313135" y2="57.2416295936589" style="stroke: #06789b; fill: #06789b;"></line><line x1="331.31313131313135" y1="57.2416295936589" x2="335.959595959596" y2="55.95716305774292" style="stroke: #06789b; fill: #06789b;"></line><line x1="335.959595959596" y1="55.95716305774292" x2="340.6060606060606" y2="54.68210691328841" style="stroke: #06789b; fill: #06789b;"></line><line x1="340.6060606060606" y1="54.68210691328841" x2="345.2525252525253" y2="53.41625731167045" style="stroke: #06789b; fill: #06789b;"></line><line x1="345.2525252525253" y1="53.41625731167045" x2="349.89898989898995" y2="52.15941765931845" style="stroke: #06789b; fill: #06789b;"></line><line x1="349.89898989898995" y1="52.15941765931845" x2="354.54545454545456" y2="50.911398261287246" style="stroke: #06789b; fill: #06789b;"></line><line x1="354.54545454545456" y1="50.911398261287246" x2="359.1919191919192" y2="49.67201598703042" style="stroke: #06789b; fill: #06789b;"></line><line x1="359.1919191919192" y1="49.67201598703042" x2="363.83838383838383" y2="48.44109395670955" style="stroke: #06789b; fill: #06789b;"></line><line x1="363.83838383838383" y1="48.44109395670955" x2="368.48484848484856" y2="47.21846124651725" style="stroke: #06789b; fill: #06789b;"></line><line x1="368.48484848484856" y1="47.21846124651725" x2="373.13131313131316" y2="46.0039526116241" style="stroke: #06789b; fill: #06789b;"></line><line x1="373.13131313131316" y1="46.0039526116241" x2="377.77777777777777" y2="44.79740822547865" style="stroke: #06789b; fill: #06789b;"></line><line x1="377.77777777777777" y1="44.79740822547865" x2="382.42424242424244" y2="43.59867343429514" style="stroke: #06789b; fill: #06789b;"></line><line x1="382.42424242424244" y1="43.59867343429514" x2="387.0707070707071" y2="42.40759852566231" style="stroke: #06789b; fill: #06789b;"></line><line x1="387.0707070707071" y1="42.40759852566231" x2="391.71717171717177" y2="41.22403851029222" style="stroke: #06789b; fill: #06789b;"></line><line x1="391.71717171717177" y1="41.22403851029222" x2="396.3636363636364" y2="40.04785291600891" style="stroke: #06789b; fill: #06789b;"></line><line x1="396.3636363636364" y1="40.04785291600891" x2="401.01010101010104" y2="38.87890559314826" style="stroke: #06789b; fill: #06789b;"></line><line x1="401.01010101010104" y1="38.87890559314826" x2="405.6565656565657" y2="37.717064530605626" style="stroke: #06789b; fill: #06789b;"></line><line x1="405.6565656565657" y1="37.717064530605626" x2="410.3030303030303" y2="36.56220168182793" style="stroke: #06789b; fill: #06789b;"></line><line x1="410.3030303030303" y1="36.56220168182793" x2="414.949494949495" y2="35.41419280010075" style="stroke: #06789b; fill: #06789b;"></line><line x1="414.949494949495" y1="35.41419280010075" x2="419.59595959595964" y2="34.2729172825311" style="stroke: #06789b; fill: #06789b;"></line><line x1="419.59595959595964" y1="34.2729172825311" x2="424.2424242424243" y2="33.138258022170646" style="stroke: #06789b; fill: #06789b;"></line><line x1="424.2424242424243" y1="33.138258022170646" x2="428.8888888888889" y2="32.010101267766686" style="stroke: #06789b; fill: #06789b;"></line><line x1="428.8888888888889" y1="32.010101267766686" x2="433.5353535353536" y2="30.888336490665267" style="stroke: #06789b; fill: #06789b;"></line><line x1="433.5353535353536" y1="30.888336490665267" x2="438.18181818181824" y2="29.772856258425605" style="stroke: #06789b; fill: #06789b;"></line><line x1="438.18181818181824" y1="29.772856258425605" x2="442.82828282828285" y2="28.663556114737077" style="stroke: #06789b; fill: #06789b;"></line><line x1="442.82828282828285" y1="28.663556114737077" x2="447.4747474747475" y2="27.56033446525808" style="stroke: #06789b; fill: #06789b;"></line><line x1="447.4747474747475" y1="27.56033446525808" x2="452.1212121212121" y2="26.463092469024843" style="stroke: #06789b; fill: #06789b;"></line><line x1="452.1212121212121" y1="26.463092469024843" x2="456.76767676767685" y2="25.371733935100536" style="stroke: #06789b; fill: #06789b;"></line><line x1="456.76767676767685" y1="25.371733935100536" x2="461.41414141414145" y2="24.286165224159475" style="stroke: #06789b; fill: #06789b;"></line><line x1="461.41414141414145" y1="24.286165224159475" x2="466.06060606060606" y2="23.206295154721033" style="stroke: #06789b; fill: #06789b;"></line><line x1="466.06060606060606" y1="23.206295154721033" x2="470.7070707070707" y2="22.132034913768138" style="stroke: #06789b; fill: #06789b;"></line><line x1="470.7070707070707" y1="22.132034913768138" x2="475.3535353535354" y2="21.063297971501754" style="stroke: #06789b; fill: #06789b;"></line><line x1="475.3535353535354" y1="21.063297971501754" x2="480" y2="20" style="stroke: #06789b; fill: #06789b;"></line></svg>

Huh?  What happened here?  I do indeed have a line now, but only the points with x > 20 are being plotted.  But the only
thing I changed was the plot elements, from circles to lines.  What is going on?

It turns out that the problem is with ``svg.selectAll('line')``. d3's  ``selectAll()`` uses CSS-style selectors to select
everything inside the parent element which matches the pattern, similar to jQuery.  However, there are already ``line``
elements inside the ``svg`` element.  They are the ticks for the axes :html_entity:`mdash` 10 each.  (The axes themselves are ``path``
elements so are not selected.)

Thus, when d3 performs ``svg.selectAll('line')`` and gets a pre |euml| xisting set of 20 line segments, its ``enter()``
method excludes those and only begins appending elements which it considers to be new. [3]_

.. |euml| unicode:: U+00EB .. e-umlaut
    :trim:

The solution is simple, like most riddles when you see the answer.  Since we don't expect the initial selector to return
anything more than the empty set anyway, change it to something guaranteed not to exist inside the ``<svg>`` element.

.. code-block:: javascript

    svg.selectAll('#line_not_in_axis_tick')
            .data(plotdata.slice(0, plotdata.length - 1))
    ...

.. raw:: html

    <svg width="500" height="250"><g class="axis" transform="translate(0,230)"><g class="tick major" transform="translate(20,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">0</text></g><g class="tick major" transform="translate(66.46464646464648,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">10</text></g><g class="tick major" transform="translate(112.92929292929294,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">20</text></g><g class="tick major" transform="translate(159.3939393939394,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">30</text></g><g class="tick major" transform="translate(205.85858585858588,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">40</text></g><g class="tick major" transform="translate(252.32323232323233,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">50</text></g><g class="tick major" transform="translate(298.7878787878788,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">60</text></g><g class="tick major" transform="translate(345.2525252525253,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">70</text></g><g class="tick major" transform="translate(391.71717171717177,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">80</text></g><g class="tick major" transform="translate(438.18181818181824,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text y="9" x="0" dy=".71em" style="text-anchor: middle;">90</text></g><path class="domain" d="M20,6V0H480V6"></path></g><g class="axis" transform="translate(20,0)"><g class="tick major" transform="translate(0,230)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">0</text></g><g class="tick major" transform="translate(0,208.89420587955655)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">1</text></g><g class="tick major" transform="translate(0,187.7884117591131)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">2</text></g><g class="tick major" transform="translate(0,166.68261763866963)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">3</text></g><g class="tick major" transform="translate(0,145.57682351822618)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">4</text></g><g class="tick major" transform="translate(0,124.47102939778273)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">5</text></g><g class="tick major" transform="translate(0,103.36523527733928)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">6</text></g><g class="tick major" transform="translate(0,82.25944115689583)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">7</text></g><g class="tick major" transform="translate(0,61.153647036452355)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">8</text></g><g class="tick major" transform="translate(0,40.04785291600891)" style="opacity: 1;"><line x2="-6" y2="0"></line><text x="-9" y="0" dy=".32em" style="text-anchor: end;">9</text></g><path class="domain" d="M-6,20H0V230H-6"></path></g><line x1="20" y1="230" x2="24.646464646464647" y2="208.89420587955655" style="stroke: #06789b; fill: #06789b;"></line><line x1="24.646464646464647" y1="208.89420587955655" x2="29.292929292929294" y2="200.15189971021454" style="stroke: #06789b; fill: #06789b;"></line><line x1="29.292929292929294" y1="200.15189971021454" x2="33.93939393939394" y2="193.44369224930347" style="stroke: #06789b; fill: #06789b;"></line><line x1="33.93939393939394" y1="193.44369224930347" x2="38.58585858585859" y2="187.7884117591131" style="stroke: #06789b; fill: #06789b;"></line><line x1="38.58585858585859" y1="187.7884117591131" x2="43.23232323232324" y2="182.80600962757305" style="stroke: #06789b; fill: #06789b;"></line><line x1="43.23232323232324" y1="182.80600962757305" x2="47.878787878787875" y2="178.30157378868026" style="stroke: #06789b; fill: #06789b;"></line><line x1="47.878787878787875" y1="178.30157378868026" x2="52.52525252525253" y2="174.15931753477741" style="stroke: #06789b; fill: #06789b;"></line><line x1="52.52525252525253" y1="174.15931753477741" x2="57.17171717171718" y2="170.30379942042907" style="stroke: #06789b; fill: #06789b;"></line><line x1="57.17171717171718" y1="170.30379942042907" x2="61.81818181818182" y2="166.68261763866963" style="stroke: #06789b; fill: #06789b;"></line><line x1="61.81818181818182" y1="166.68261763866963" x2="66.46464646464648" y2="163.25761875280853" style="stroke: #06789b; fill: #06789b;"></line><line x1="66.46464646464648" y1="163.25761875280853" x2="71.11111111111111" y2="160" style="stroke: #06789b; fill: #06789b;"></line><line x1="71.11111111111111" y1="160" x2="75.75757575757575" y2="156.88738449860693" style="stroke: #06789b; fill: #06789b;"></line><line x1="75.75757575757575" y1="156.88738449860693" x2="80.40404040404042" y2="153.90197708935474" style="stroke: #06789b; fill: #06789b;"></line><line x1="80.40404040404042" y1="153.90197708935474" x2="85.05050505050507" y2="151.0293495255127" style="stroke: #06789b; fill: #06789b;"></line><line x1="85.05050505050507" y1="151.0293495255127" x2="89.6969696969697" y2="148.2576108630401" style="stroke: #06789b; fill: #06789b;"></line><line x1="89.6969696969697" y1="148.2576108630401" x2="94.34343434343435" y2="145.57682351822618" style="stroke: #06789b; fill: #06789b;"></line><line x1="94.34343434343435" y1="145.57682351822618" x2="98.989898989899" y2="142.97858152887147" style="stroke: #06789b; fill: #06789b;"></line><line x1="98.989898989899" y1="142.97858152887147" x2="103.63636363636364" y2="140.4556991306436" style="stroke: #06789b; fill: #06789b;"></line><line x1="103.63636363636364" y1="140.4556991306436" x2="108.28282828282829" y2="138.00197630581204" style="stroke: #06789b; fill: #06789b;"></line><line x1="108.28282828282829" y1="138.00197630581204" x2="112.92929292929294" y2="135.6120192551461" style="stroke: #06789b; fill: #06789b;"></line><line x1="112.92929292929294" y1="135.6120192551461" x2="117.57575757575758" y2="133.28110084091395" style="stroke: #06789b; fill: #06789b;"></line><line x1="117.57575757575758" y1="133.28110084091395" x2="122.22222222222223" y2="131.00505063388334" style="stroke: #06789b; fill: #06789b;"></line><line x1="122.22222222222223" y1="131.00505063388334" x2="126.86868686868688" y2="128.78016723262903" style="stroke: #06789b; fill: #06789b;"></line><line x1="126.86868686868688" y1="128.78016723262903" x2="131.5151515151515" y2="126.60314757736052" style="stroke: #06789b; fill: #06789b;"></line><line x1="131.5151515151515" y1="126.60314757736052" x2="136.16161616161617" y2="124.47102939778273" style="stroke: #06789b; fill: #06789b;"></line><line x1="136.16161616161617" y1="124.47102939778273" x2="140.80808080808083" y2="122.38114392998698" style="stroke: #06789b; fill: #06789b;"></line><line x1="140.80808080808083" y1="122.38114392998698" x2="145.45454545454547" y2="120.33107674791036" style="stroke: #06789b; fill: #06789b;"></line><line x1="145.45454545454547" y1="120.33107674791036" x2="150.10101010101013" y2="118.3186350695548" style="stroke: #06789b; fill: #06789b;"></line><line x1="150.10101010101013" y1="118.3186350695548" x2="154.74747474747474" y2="116.34182027596158" style="stroke: #06789b; fill: #06789b;"></line><line x1="154.74747474747474" y1="116.34182027596158" x2="159.3939393939394" y2="114.39880466173213" style="stroke: #06789b; fill: #06789b;"></line><line x1="159.3939393939394" y1="114.39880466173213" x2="164.04040404040404" y2="112.48791164696755" style="stroke: #06789b; fill: #06789b;"></line><line x1="164.04040404040404" y1="112.48791164696755" x2="168.6868686868687" y2="110.60759884085815" style="stroke: #06789b; fill: #06789b;"></line><line x1="168.6868686868687" y1="110.60759884085815" x2="173.33333333333334" y2="108.7564434701786" style="stroke: #06789b; fill: #06789b;"></line><line x1="173.33333333333334" y1="108.7564434701786" x2="177.979797979798" y2="106.93312978118543" style="stroke: #06789b; fill: #06789b;"></line><line x1="177.979797979798" y1="106.93312978118543" x2="182.62626262626264" y2="105.13643809778173" style="stroke: #06789b; fill: #06789b;"></line><line x1="182.62626262626264" y1="105.13643809778173" x2="187.27272727272728" y2="103.36523527733928" style="stroke: #06789b; fill: #06789b;"></line><line x1="187.27272727272728" y1="103.36523527733928" x2="191.91919191919192" y2="101.6184663519781" style="stroke: #06789b; fill: #06789b;"></line><line x1="191.91919191919192" y1="101.6184663519781" x2="196.56565656565658" y2="99.89514718015809" style="stroke: #06789b; fill: #06789b;"></line><line x1="196.56565656565658" y1="99.89514718015809" x2="201.21212121212122" y2="98.19435796322196" style="stroke: #06789b; fill: #06789b;"></line><line x1="201.21212121212122" y1="98.19435796322196" x2="205.85858585858588" y2="96.51523750561705" style="stroke: #06789b; fill: #06789b;"></line><line x1="205.85858585858588" y1="96.51523750561705" x2="210.50505050505052" y2="94.8569781171208" style="stroke: #06789b; fill: #06789b;"></line><line x1="210.50505050505052" y1="94.8569781171208" x2="215.15151515151516" y2="93.21882107142477" style="stroke: #06789b; fill: #06789b;"></line><line x1="215.15151515151516" y1="93.21882107142477" x2="219.79797979797982" y2="91.60005254861744" style="stroke: #06789b; fill: #06789b;"></line><line x1="219.79797979797982" y1="91.60005254861744" x2="224.44444444444446" y2="90" style="stroke: #06789b; fill: #06789b;"></line><line x1="224.44444444444446" y1="90" x2="229.09090909090912" y2="88.41802888271914" style="stroke: #06789b; fill: #06789b;"></line><line x1="229.09090909090912" y1="88.41802888271914" x2="233.73737373737376" y2="86.85353971924735" style="stroke: #06789b; fill: #06789b;"></line><line x1="233.73737373737376" y1="86.85353971924735" x2="238.38383838383842" y2="85.30596544306451" style="stroke: #06789b; fill: #06789b;"></line><line x1="238.38383838383842" y1="85.30596544306451" x2="243.03030303030303" y2="83.77476899721384" style="stroke: #06789b; fill: #06789b;"></line><line x1="243.03030303030303" y1="83.77476899721384" x2="247.6767676767677" y2="82.25944115689583" style="stroke: #06789b; fill: #06789b;"></line><line x1="247.6767676767677" y1="82.25944115689583" x2="252.32323232323233" y2="80.75949855107271" style="stroke: #06789b; fill: #06789b;"></line><line x1="252.32323232323233" y1="80.75949855107271" x2="256.969696969697" y2="79.27448186129257" style="stroke: #06789b; fill: #06789b;"></line><line x1="256.969696969697" y1="79.27448186129257" x2="261.61616161616166" y2="77.80395417870949" style="stroke: #06789b; fill: #06789b;"></line><line x1="261.61616161616166" y1="77.80395417870949" x2="266.26262626262627" y2="76.347499502641" style="stroke: #06789b; fill: #06789b;"></line><line x1="266.26262626262627" y1="76.347499502641" x2="270.90909090909093" y2="74.90472136604075" style="stroke: #06789b; fill: #06789b;"></line><line x1="270.90909090909093" y1="74.90472136604075" x2="275.55555555555554" y2="73.47524157501473" style="stroke: #06789b; fill: #06789b;"></line><line x1="275.55555555555554" y1="73.47524157501473" x2="280.20202020202026" y2="72.05869905102546" style="stroke: #06789b; fill: #06789b;"></line><line x1="280.20202020202026" y1="72.05869905102546" x2="284.8484848484849" y2="70.65474876574109" style="stroke: #06789b; fill: #06789b;"></line><line x1="284.8484848484849" y1="70.65474876574109" x2="289.4949494949495" y2="69.26306075962614" style="stroke: #06789b; fill: #06789b;"></line><line x1="289.4949494949495" y1="69.26306075962614" x2="294.14141414141415" y2="67.88331923636551" style="stroke: #06789b; fill: #06789b;"></line><line x1="294.14141414141415" y1="67.88331923636551" x2="298.7878787878788" y2="66.51522172608017" style="stroke: #06789b; fill: #06789b;"></line><line x1="298.7878787878788" y1="66.51522172608017" x2="303.4343434343435" y2="65.15847831105395" style="stroke: #06789b; fill: #06789b;"></line><line x1="303.4343434343435" y1="65.15847831105395" x2="308.0808080808081" y2="63.812810908356056" style="stroke: #06789b; fill: #06789b;"></line><line x1="308.0808080808081" y1="63.812810908356056" x2="312.72727272727275" y2="62.47795260433219" style="stroke: #06789b; fill: #06789b;"></line><line x1="312.72727272727275" y1="62.47795260433219" x2="317.3737373737374" y2="61.153647036452355" style="stroke: #06789b; fill: #06789b;"></line><line x1="317.3737373737374" y1="61.153647036452355" x2="322.020202020202" y2="59.839647818460804" style="stroke: #06789b; fill: #06789b;"></line><line x1="322.020202020202" y1="59.839647818460804" x2="326.6666666666667" y2="58.5357180051775" style="stroke: #06789b; fill: #06789b;"></line><line x1="326.6666666666667" y1="58.5357180051775" x2="331.31313131313135" y2="57.2416295936589" style="stroke: #06789b; fill: #06789b;"></line><line x1="331.31313131313135" y1="57.2416295936589" x2="335.959595959596" y2="55.95716305774292" style="stroke: #06789b; fill: #06789b;"></line><line x1="335.959595959596" y1="55.95716305774292" x2="340.6060606060606" y2="54.68210691328841" style="stroke: #06789b; fill: #06789b;"></line><line x1="340.6060606060606" y1="54.68210691328841" x2="345.2525252525253" y2="53.41625731167045" style="stroke: #06789b; fill: #06789b;"></line><line x1="345.2525252525253" y1="53.41625731167045" x2="349.89898989898995" y2="52.15941765931845" style="stroke: #06789b; fill: #06789b;"></line><line x1="349.89898989898995" y1="52.15941765931845" x2="354.54545454545456" y2="50.911398261287246" style="stroke: #06789b; fill: #06789b;"></line><line x1="354.54545454545456" y1="50.911398261287246" x2="359.1919191919192" y2="49.67201598703042" style="stroke: #06789b; fill: #06789b;"></line><line x1="359.1919191919192" y1="49.67201598703042" x2="363.83838383838383" y2="48.44109395670955" style="stroke: #06789b; fill: #06789b;"></line><line x1="363.83838383838383" y1="48.44109395670955" x2="368.48484848484856" y2="47.21846124651725" style="stroke: #06789b; fill: #06789b;"></line><line x1="368.48484848484856" y1="47.21846124651725" x2="373.13131313131316" y2="46.0039526116241" style="stroke: #06789b; fill: #06789b;"></line><line x1="373.13131313131316" y1="46.0039526116241" x2="377.77777777777777" y2="44.79740822547865" style="stroke: #06789b; fill: #06789b;"></line><line x1="377.77777777777777" y1="44.79740822547865" x2="382.42424242424244" y2="43.59867343429514" style="stroke: #06789b; fill: #06789b;"></line><line x1="382.42424242424244" y1="43.59867343429514" x2="387.0707070707071" y2="42.40759852566231" style="stroke: #06789b; fill: #06789b;"></line><line x1="387.0707070707071" y1="42.40759852566231" x2="391.71717171717177" y2="41.22403851029222" style="stroke: #06789b; fill: #06789b;"></line><line x1="391.71717171717177" y1="41.22403851029222" x2="396.3636363636364" y2="40.04785291600891" style="stroke: #06789b; fill: #06789b;"></line><line x1="396.3636363636364" y1="40.04785291600891" x2="401.01010101010104" y2="38.87890559314826" style="stroke: #06789b; fill: #06789b;"></line><line x1="401.01010101010104" y1="38.87890559314826" x2="405.6565656565657" y2="37.717064530605626" style="stroke: #06789b; fill: #06789b;"></line><line x1="405.6565656565657" y1="37.717064530605626" x2="410.3030303030303" y2="36.56220168182793" style="stroke: #06789b; fill: #06789b;"></line><line x1="410.3030303030303" y1="36.56220168182793" x2="414.949494949495" y2="35.41419280010075" style="stroke: #06789b; fill: #06789b;"></line><line x1="414.949494949495" y1="35.41419280010075" x2="419.59595959595964" y2="34.2729172825311" style="stroke: #06789b; fill: #06789b;"></line><line x1="419.59595959595964" y1="34.2729172825311" x2="424.2424242424243" y2="33.138258022170646" style="stroke: #06789b; fill: #06789b;"></line><line x1="424.2424242424243" y1="33.138258022170646" x2="428.8888888888889" y2="32.010101267766686" style="stroke: #06789b; fill: #06789b;"></line><line x1="428.8888888888889" y1="32.010101267766686" x2="433.5353535353536" y2="30.888336490665267" style="stroke: #06789b; fill: #06789b;"></line><line x1="433.5353535353536" y1="30.888336490665267" x2="438.18181818181824" y2="29.772856258425605" style="stroke: #06789b; fill: #06789b;"></line><line x1="438.18181818181824" y1="29.772856258425605" x2="442.82828282828285" y2="28.663556114737077" style="stroke: #06789b; fill: #06789b;"></line><line x1="442.82828282828285" y1="28.663556114737077" x2="447.4747474747475" y2="27.56033446525808" style="stroke: #06789b; fill: #06789b;"></line><line x1="447.4747474747475" y1="27.56033446525808" x2="452.1212121212121" y2="26.463092469024843" style="stroke: #06789b; fill: #06789b;"></line><line x1="452.1212121212121" y1="26.463092469024843" x2="456.76767676767685" y2="25.371733935100536" style="stroke: #06789b; fill: #06789b;"></line><line x1="456.76767676767685" y1="25.371733935100536" x2="461.41414141414145" y2="24.286165224159475" style="stroke: #06789b; fill: #06789b;"></line><line x1="461.41414141414145" y1="24.286165224159475" x2="466.06060606060606" y2="23.206295154721033" style="stroke: #06789b; fill: #06789b;"></line><line x1="466.06060606060606" y1="23.206295154721033" x2="470.7070707070707" y2="22.132034913768138" style="stroke: #06789b; fill: #06789b;"></line><line x1="470.7070707070707" y1="22.132034913768138" x2="475.3535353535354" y2="21.063297971501754" style="stroke: #06789b; fill: #06789b;"></line><line x1="475.3535353535354" y1="21.063297971501754" x2="480" y2="20" style="stroke: #06789b; fill: #06789b;"></line></svg>

And there it is!  Our prettily-plotted square root curve.

Wrapping Up
===========

The full code for this demo can be found `here <|filename|../demo-examples/gc-demo1.html>`_.  There is
plenty yet to do :html_entity:`mdash` for example, SVG provides a ``path`` element which is better suited to drawing
continuous line segments than ``line`` is.
I also need to work with making the domain and range even more dynamic.  Look for `part 2
<|filename|2013-07-09_graphing-calculator-part-2.rst>`_ coming soon!

Footnotes
---------

.. [1] Refreshers from Scott's tutorial on `axes <http://alignedleft.com/tutorials/d3/axes/>`_ and `scales
       <http://alignedleft.com/tutorials/d3/scales/>`_.
.. [2] Scatterplot tutorial is at `http://alignedleft.com/tutorials/d3/making-a-scatterplot/
        <http://alignedleft.com/tutorials/d3/making-a-scatterplot/>`_.
.. [3] ``selectAll()`` and ``enter()`` really confused me when I started working with d3.  I didn't get deconfused until
    I read Mike Bostock's `Thinking With Joins <http://bost.ocks.org/mike/join/>`_.